function [M] = MomentsClosedForm(M, t, c, Z)

c2 = c(2);
c3 = c(3);
c4 = c(4);

x1 = M(1);
x2 = M(2);
x3 = M(3);
x11 = M(4);
x12 = M(5);
x13 = M(6);
x22 = M(7);
x23 = M(8);
x33 = M(9);
x113 = M(10);
x123 = M(11);
x133 = M(12);
x1133 = M(13);   
   

% x1 = 0;
% x2 = 0;
% x3 = 1;
% x11 = 0;
% x12 = 0;
% x13 = 0;
% x22 = 0;
% x23 = 0;
% x33 = 1;
% x113 = 0;
% x133 = 0;
% x123 = 0;
% x1133 = 0;

%t = 10000;


X1 = (exp(-c2*t)*(c2*x1 + (-1 + exp(c2*t))*Z))/c2;

  X11 = (...
   exp(-2*c2*t)*(c2^2*((-1 + exp(c2*t))*x1 + x11) + ...
      c2*(-1 + exp(c2*t))*(exp(c2*t) + 2*x1)*Z + (-1 + exp(...
         c2*t))^2*Z^2))/c2^2;

  X12 = (1/(c2^2*(c2 - c4)*c4*(c2 + c4)))*exp(-(2*c2 + c4)*t)*(c2^4*exp(c2*t)*(c4*x12 + c3*(-1 + exp(c4*t))*x13) - ...
      c3*c4^2*exp(c4*t)*(-1 + exp(c2*t))^2*x3*Z^2 + c2^3*(c3*c4*(exp(c2*t) - ...
      exp(c4*t))*(x113 - x13) + c4*exp(c2*t)*(-1 + exp(c2*t))*x2*Z + ...
      c3*exp(c2*t)*(-1 + exp(c4*t))*(x13 - x3)*Z) - c2*c4*(-1 + exp(c2*t))*Z*(c4^2*exp(c2*t)*x2 +...
      c3*c4*(-exp(c2*t)*x13 + 2*exp(c4*t)*x13 + exp((c2 + c4)*t)*x3) + ...
      c3*(exp(c2*t) - exp(c4*t))*x3*Z) + ...
      c2^2*(-c4^3*exp(c2*t)*x12 + ...
         c3*(c4^2*(exp(c2*t)*x113 - exp((c2 + c4)*t)*x13 + ...
               exp(c4*t)*(-x113 + x13)) + ...
            c4*(exp(2*c2*t)*x13 + 2*exp(c4*t)*x13 - ...
               exp((c2 + c4)*t)*x13 + exp((2*c2 + c4)*t)*x3 - ...
               exp(c2*t)*(2*x13 + x3))*Z + ...
            exp(c2*t)*(-1 + exp(c2*t))*(-1 + exp(c4*t))*x3*Z^2)));
        
  X13 = (exp(-c2*t)*(c2*x13 + (-1 + exp(c2*t))*x3*Z))/c2; 

  X2 = (exp(-(c2 + c4)*t)*(c2*exp(c2*t)*((c2 - c4)*c4*x2 + c3*(c4*x13 - x3*Z)) + ...
      c3*exp(c4*t)*((c2 - c4)*exp(c2*t)*x3*Z + c4*(-c2*x13 + x3*Z))))/(...
   c2*(c2 - c4)*c4);
   
  X22 = (1/(2*c2^2*(c2 - 2*c4)*(c2 - c4)^2*c4^2*(c2 + c4)))...
   *exp(-(c2 + ...
        c4)*t)*(2*c2^6*c4^2*exp((c2 - c4)*t)*((-1 + exp(c4*t))*x2 + ...
         x22) + 2*c2^5*c4*(-2*c3^2*(-1 + exp(c4*t))*x133 - ...
         3*c4^2*exp((c2 - c4)*t)*((-1 + exp(c4*t))*x2 + x22) + ...
         c3*(2*c4*(-1 + exp((c2 - c4)*t))*x123 + ...
            c4*(exp(c2*t) - exp(c4*t))*x13 + ...
            exp((c2 - c4)*t)*(-1 + exp(c4*t))*(2*x23 + ...
               exp(c4*t)*x3)*Z)) + ...
      2*c2*c3*c4^3*exp(-c2*t)*(-1 + exp(...
         c2*t))*(-2*c4^2*exp(c2*t)*(2*x23 + exp(c4*t)*x3)*Z + ...
         c3*(-4*exp(c2*t) + exp(c4*t) + 3*exp((c2 + c4)*t))*x33*Z^2 + ...
         c3*c4*(4*exp(c2*t)*x133*Z - exp((c2 + c4)*t)*x33*(1 +Z) + ...
            exp(c4*t)*(x33*(-1 + Z) - 4*x133*Z))) + ...
      c2^3*c4*exp(-(c2 + c4)*t)*(6*c4^4*exp(...
          2*c2*t)*((-1 + exp(c4*t))*x2 + x22) + ...
         2*c3*c4^2*exp(...
          c2*t)*(-c4*(exp(c2*t) - exp(c4*t))*(2*x123 + ...
               exp(c4*t)*x13) + (exp(c2*t) - 2*exp(c4*t) + ...
               exp((c2 + c4)*t))*(2*x23 + exp(c4*t)*x3)*Z) + ...
         c3^2*(2*c4^2*(2*exp((c2 + c4)*t)*(x1133 - 2*x133) + ...
               2*exp((c2 + 2*c4)*t)*x133 + exp(2*c2*t)*(-x1133 + x133) + ...
                exp(2*c4*t)*(-x1133 + x133)) + ...
            2*exp(c2*t)*(-1 + exp(c4*t))*(exp(c2*t) + 2*exp(c4*t) - ...
               3*exp((c2 + c4)*t))*x33*Z^2 + ...
            c4*(-8*exp((2*c2 + c4)*t)*x133*Z + ...
               4*exp((c2 + 2*c4)*t)*(2*x133 - x33)*Z - ...
               4*exp(2*(c2 + c4)*t)*x33*(1 + Z) + ...
               4*exp((c2 + c4)*t)*x33*(1 + 2*Z) + ...
               exp(2*c4*t)*(x33*(-1 +Z) - 4*x133*Z) + ...
               exp(2*c2*t)*(x33 + 4*x133*Z - x33*Z)))) + ...
      c2^2*c4^2*exp(-(c2 + c4)*t)*(-4*c4^4*exp(...
          2*c2*t)*((-1 + exp(c4*t))*x2 + x22) + ...
         2*c3*c4^2*exp(...
          c2*t)*(2*c4*(exp(c2*t) - exp(c4*t))*(2*x123 + ...
               exp(c4*t)*x13) - (2*exp(c2*t) + exp(c4*t) - ...
               3*exp((c2 + c4)*t))*(2*x23 + exp(c4*t)*x3)*Z) + ...
         c3^2*(-4*c4^2*(exp(2*c2*t)*x1133 - 2*exp((c2 + c4)*t)*x1133 + ...
               exp(2*c4*t)*(x1133 - x133) + exp((c2 + 2*c4)*t)*x133) - ...
            2*(2*exp(2*c2*t) - exp(2*c4*t) - 2*exp((c2 + c4)*t) - exp(...
               2*(c2 + c4)*t) - 2*exp((2*c2 + c4)*t) + ...
               4*exp((c2 + 2*c4)*t))*x33*Z^2 + ...
            c4*(-4*exp((2*c2 + c4)*t)*x133*Z + ...
               4*exp((c2 + 2*c4)*t)*(x133 - x33)*Z + ...
               5*exp(2*(c2 + c4)*t)*x33*(1 +Z) - ...
               4*exp((c2 + c4)*t)*(2*x33 + 3*x133*Z) + ...
               2*exp(2*c2*t)*(x33 + 4*x133*Z) + ...
               exp(2*c4*t)*(x33 + 4*x133*Z - x33*Z)))) + ...
      c2^4*exp(-(c2 + c4)*t)*(2*c4^4*exp(...
          2*c2*t)*((-1 + exp(c4*t))*x2 + x22) - ...
         2*c3*c4^2*exp(...
          c2*t)*(2*c4*(exp(c2*t) - exp(c4*t))*(2*x123 + ...
               exp(c4*t)*x13) - (2*exp(c2*t) + exp(c4*t) - ...
               3*exp((c2 + c4)*t))*(2*x23 + exp(c4*t)*x3)*Z) + ...
         c3^2*(2*c4^2*(exp(2*c4*t)*(x1133 - x133) + ...
               2*exp((c2 + 2*c4)*t)*x133 + exp(2*c2*t)*(x1133 + x133) - ...
               2*exp((c2 + c4)*t)*(x1133 + x133)) + ...
            2*exp(2*c2*t)*(-1 + exp(c4*t))^2*x33*Z^2 + ...
            c4*exp(c2*t)*(-1 + exp(c4*t))*(-4*exp(c4*t)*(x133 - x33)*Z + ...
               exp((c2 + c4)*t)*x33*(1 +Z) + ...
               exp(c2*t)*(x33 + 4*x133*Z + x33*Z)))) - ...
      8*c3^2*c4^4*exp(c4*t)*x33*Z^2*(-1 + cosh(c2*t)));
      
  X23 = (...
   exp(-(c2 + c4)*t)*(c2*exp(...
       c2*t)*((c2 - c4)*c4*x23 + c3*(c4*x133 - x33*Z)) + ...
      c3*exp(c4*t)*((c2 - c4)*exp(c2*t)*x33*Z + ...
         c4*(-c2*x133 + x33*Z))))/(c2*(c2 - c4)*c4);
     
     
     
     X133 = (exp(-c2*t)*(c2*x133 + (-1 + exp(c2*t))*x33*Z))/c2;
     
     X123 = (1/(2*c2^2*(c2 - c4)*c4*(c2 + c4)))...
 *exp(-(2*c2 + c4)*t)*(2*c2^4*exp(...
     c2*t)*(c4*x123 + c3*(-1 + exp(c4*t))*x133) - ...
    2*c3*c4^2*exp(c4*t)*(-1 + exp(c2*t))^2*x33*Z^2 + ...
    2*c2^3*(c3*c4*(exp(c2*t) - exp(c4*t))*(x1133 - x133) + ...
       c4*exp(c2*t)*(-1 + exp(c2*t))*x23*Z + ...
       c3*exp(c2*t)*(-1 + exp(c4*t))*(x133 - x33)*Z) - ...
    c2*c4*(-1 + exp(c2*t))*(2*c4^2*exp(c2*t)*x23*Z + ...
       2*c3*(exp(c2*t) - exp(c4*t))*x33*Z^2 + ...
       c3*c4*(-2*exp(c2*t)*x133*Z + exp((c2 + c4)*t)*x33*(1 + Z) + ...
          exp(c4*t)*(x33 + 4*x133*Z - x33*Z))) + ...
    c2^2*(-2*c4^3*exp(c2*t)*x123 + ...
       c3*(2*c4^2*(exp(c2*t)*x1133 - exp((c2 + c4)*t)*x133 + ...
             exp(c4*t)*(-x1133 + x133)) + ...
          2*exp(c2*t)*(-1 + exp(c2*t))*(-1 + exp(c4*t))*x33*Z^2 + ...
          c4*(2*exp(2*c2*t)*x133*Z - 2*exp((c2 + c4)*t)*x133*Z + ...
             exp((2*c2 + c4)*t)*x33*(1 + Z) - ...
             2*exp(c2*t)*(x33 + 2*x133*Z) + ...
             exp(c4*t)*(x33 + 4*x133*Z - x33*Z)))));...
             
             
             X113 = (...
 exp(-2*c2*t)*(c2^2*(x113 + (-1 + exp(c2*t))*x13) + ...
    c2*(-1 + exp(c2*t))*(2*x13 + exp(c2*t)*x3)*Z + (-1 + exp(...
       c2*t))^2*x3*Z^2))/c2^2; 
   
X1133 = (exp(-2*c2*t)*(2*c2^2*(x1133 + (-1 + exp(c2*t))*x133) + 2*(-1 + exp(c2*t))^2*x33*Z^2 + c2*(-1 + exp(c2*t))*(x33 + 4*x133*Z - x33*Z + exp(c2*t)*x33*(1 + Z))))/(2*c2^2);

   
%    (E^(-2 c2 t) (2 c2^2 (x1133 + (-1 + E^(c2 t)) x133) + 
%    2 (-1 + E^(c2 t))^2 x33 Z^2 + 
%    c2 (-1 + E^(c2 t)) (x33 + 4 x133 Z - x33 Z + 
%       E^(c2 t) x33 (1 + Z))))/(2 c2^2)
%       
       
M(1) = X1;
M(2) = X2;
M(3) = M(3);
M(4) = X11;
M(5) = X12;
M(6) = X13;
M(7) = X22;%
M(8) = X23;
M(9) = M(9);
M(10) = X113;
M(11) = X123;%
M(12) = X133;
M(13) = X1133;%
